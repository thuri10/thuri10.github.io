<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('dark');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Android Application Security Series - Part2</title><meta name="robots" content="follow, index"/><meta name="description" content="Firebase, Local Sqlite and AWS storage security weaknesses."/><meta property="og:url" content="https://thuri10.github.io/blog/android-security-part2"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Solar Bits"/><meta property="og:description" content="Firebase, Local Sqlite and AWS storage security weaknesses."/><meta property="og:title" content="Android Application Security Series - Part2"/><meta property="og:image" content="https://thuri10.github.io/static/images/android/firebase.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/0xhexski"/><meta name="twitter:title" content="Android Application Security Series - Part2"/><meta name="twitter:description" content="Firebase, Local Sqlite and AWS storage security weaknesses."/><meta name="twitter:image" content="https://thuri10.github.io/static/images/android/firebase.jpg"/><link rel="canonical" href="https://thuri10.github.io/blog/android-security-part2"/><meta property="article:published_time" content="2021-10-25T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://thuri10.github.io/blog/android-security-part2"
  },
  "headline": "Android Application Security Series - Part2",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://thuri10.github.io/static/images/android/firebase.jpg"
    }
  ],
  "datePublished": "2021-10-25T00:00:00.000Z",
  "dateModified": "2021-10-25T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Thuri"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Thuri10",
    "logo": {
      "@type": "ImageObject",
      "url": "https://thuri10.github.io/static/images/logo.png"
    }
  },
  "description": "Firebase, Local Sqlite and AWS storage security weaknesses."
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/85171d873f14ba6a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/85171d873f14ba6a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-e8c18a6c297e8d48.js" defer=""></script><script src="/_next/static/chunks/framework-97d5d6e713538c3d.js" defer=""></script><script src="/_next/static/chunks/main-56cb050b8f4d5bdc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b8f1a2a9a54e1f44.js" defer=""></script><script src="/_next/static/chunks/623-c1c42e432517d218.js" defer=""></script><script src="/_next/static/chunks/418-25ea0c7be4f6e68e.js" defer=""></script><script src="/_next/static/chunks/620-89efe9db4b74724d.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-6f738025c6f4cc25.js" defer=""></script><script src="/_next/static/bDYVdcnFQ4pUuvvBtmBw4/_buildManifest.js" defer=""></script><script src="/_next/static/bDYVdcnFQ4pUuvvBtmBw4/_ssgManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="SolarBits" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="344.564 330.278 111.737 91.218" width="53.87" height="43.61"><defs><linearGradient id="logo_svg__b" gradientUnits="userSpaceOnUse" x1="420.97" y1="331.28" x2="420.97" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><linearGradient id="logo_svg__d" gradientUnits="userSpaceOnUse" x1="377.89" y1="331.28" x2="377.89" y2="418.5"><stop style="stop-color:#06b6d4;stop-opacity:1" offset="0%"></stop><stop style="stop-color:#67e8f9;stop-opacity:1" offset="100%"></stop></linearGradient><path d="M453.3 331.28v28.57l-64.66 58.65v-30.08l64.66-57.14Z" id="logo_svg__a"></path><path d="M410.23 331.28v28.57l-64.67 58.65v-30.08l64.67-57.14Z" id="logo_svg__c"></path></defs><use xlink:href="#logo_svg__a" fill="url(#logo_svg__b)"></use><use xlink:href="#logo_svg__c" fill="url(#logo_svg__d)"></use></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">SolarBits</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:flex"><button aria-label="Scroll To Top" type="button" style="opacity:0" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="relative pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><div><h1 class="text-3xl font-bold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Android Application Security Series - Part2</h1></div><dd class="flex items-center justify-center text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2021-10-25" class="flex items-center"><i class="inline-block twa  twa-calendar"></i><span class="ml-1.5">Monday, October 25, 2021</span></time><span class="mx-2">-</span><div class="flex items-center"><i class="inline-block twa  twa-hourglass-not-done"></i><span class="ml-1.5">13 mins read</span></div></dd></div></dl></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-5 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h1 id="insecure-storages"><a href="#insecure-storages" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Insecure Storages</h1><p>This is the second part series of the android application security. This part focuses on the security of sqlite databases, firebase and AWS security.</p><h2 id="flag7---sqlite"><a href="#flag7---sqlite" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flag7 - Sqlite</h2><p><strong>What is sqlite?</strong></p><p>Sqlite is a structure query base database that enables applications to do local storage in the application directory. The goal of the challenge is to understand how local storage of databases may lead to leakage of information.</p><p>First step is to decompile the FlagSevenSqliteActivity using jadx.</p><p>During the analysis of new android activity, we start analysis on the onCreate method.<strong>oncreate</strong> is the first method to be called by an application when an activity is started.</p><p>The decompiled oncreate method is as shown below.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> bundle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>bundle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_flag_seven_sqlite<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Toolbar</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>toolbar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    j<span class="token punctuation">.</span>g<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">H</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">FloatingActionButton</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>fab<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">SQLiteDatabase</span> writableDatabase <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>u<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">ContentValues</span> contentValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;VGhlIGZsYWcgaGFzaCE=&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;subtitle&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    writableDatabase<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;Thisisatest&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> contentValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;subtitle&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    writableDatabase<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;Thisisatest&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> contentValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>From the analysis of the above code, the method is passing some base64 encoded strings and storing them into string variables.From the hint of application name, we are creating writable database through SQLiteDatabase functions. In this application we are writing some strings to the database. The name of the database being referenced is <strong>Thisisatest</strong> database.</p><p>Next step is decode all base64 encoded strings in order to understand the logic of the program. The decoded strings below.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">VGhlIGZsYWcgaGFzaCE    - The flag hash<span class="token operator">!</span> 
</span><span class="code-line">MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc - 2ab96390c7dbe3439de74d0c9b0b1767
</span><span class="code-line">VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ  - The flag is also a password<span class="token operator">!</span>
</span></code></pre></div><p>The above decoded strings gives us an hint on solving the challenge. The author provides us with the hash of the flag.</p><p>The activity defines some interesting strings in the application, we decode the strings as shown in the code below.</p><div class="relative"><pre><code class="code-highlight language-kotlin"><span class="code-line"><span class="token keyword">private</span> <span class="token keyword">final</span> String w <span class="token operator">=</span> <span class="token singleline string-literal"><span class="token string">&quot;ZjFhZy1wYTU1&quot;</span></span><span class="token punctuation">;</span>   #f1ag<span class="token operator">-</span>pa55
</span><span class="code-line"><span class="token keyword">private</span> byte<span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token singleline string-literal"><span class="token string">&quot;c3FsaXRl&quot;</span></span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  #sqlite
</span><span class="code-line"><span class="token keyword">private</span> byte<span class="token punctuation">[</span><span class="token punctuation">]</span> y <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>w<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">private</span> <span class="token keyword">final</span> String z<span class="token punctuation">;</span>
</span></code></pre></div><p>Next is to analyze the FlagSevensqliteActivity in order to understand the usage of the above strings in our activity. Important strings form the above are <strong>f1ag-pa55</strong> and <strong>sqlite</strong>.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line">
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">FlagSevenSqliteActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>      <span class="token comment">//sqlite</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>bArr<span class="token punctuation">,</span> <span class="token string">&quot;decodedDirectoryOne&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name">Charset</span> charset <span class="token operator">=</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>charset<span class="token punctuation">,</span> <span class="token string">&quot;StandardCharsets.UTF_8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bArr<span class="token punctuation">,</span> charset<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>        <span class="token comment">//f1ag-pa55</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>bArr2<span class="token punctuation">,</span> <span class="token string">&quot;decodedDirectoryTwo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name">Charset</span> charset2 <span class="token operator">=</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>charset2<span class="token punctuation">,</span> <span class="token string">&quot;StandardCharsets.UTF_8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bArr2<span class="token punctuation">,</span> charset2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        f b2 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>b2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        d d2 <span class="token operator">=</span> b2<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance().reference&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>B</span> <span class="token operator">=</span> d2<span class="token punctuation">;</span>
</span><span class="code-line">        d h <span class="token operator">=</span> d2<span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">&quot;database.child(refDirectory)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>C</span> <span class="token operator">=</span> h<span class="token punctuation">;</span>
</span><span class="code-line">        d h2 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>B</span><span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>h2<span class="token punctuation">,</span> <span class="token string">&quot;database.child(refDirectoryTwo)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>D</span> <span class="token operator">=</span> h2<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div><p>From the above decompiled <strong>flagSevensqliteActivity</strong>, shows how the application is parsing the data from the firebase instance. In order to understand the data we are fetching, we need to know the nodes we are fetching the data from. From the decompiled code, we are accessing the string x as shown in the constructor method in line 1 through bArr byte array. our string is then passed to variable z constructor method as referenced by <strong>this.z</strong> constructor.</p><p>This means, <strong>f1ag-pa55</strong> and <strong>sqlite</strong> are our firebase nodes.</p><p>To get the firebase link, we look for the link the <strong>strings.xml</strong> in the resources directory of the application.The link of the firebase url is shown in the image below. Manually test firebase endpoints manually to see if they are vulnerable as shown in the code below. Adding .json at the end of the firebase endpoint enables one to read data.</p><p>First we test our endpoint using <strong>sqlite</strong> node.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:output$ <span class="token function">curl</span> https://injuredandroid.firebaseio.com/sqlite.json
</span><span class="code-line"><span class="token string">&quot;S3V3N_11&quot;</span>
</span></code></pre></div><p>From the results of the above, we get our flag. Accessing the endpoint using <strong>f1ag-pa55</strong> using .json firebase trick, we get our password.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:output$ <span class="token function">curl</span> https://injuredandroid.firebaseio.com/f1ag-pa55.json
</span><span class="code-line"><span class="token string">&quot;hunter2&quot;</span>
</span></code></pre></div><p><strong>hunter2</strong> is our correct password for the challenge.</p><h2 id="flag8---aws-storage-and-security"><a href="#flag8---aws-storage-and-security" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>FLag8 - AWS Storage and Security.</h2><p>This challenge is about understanding the misconfiguration of AWS storage and security implementation in the android applications.</p><p>The decompiled flagEightclass activity code looks like the one below.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">FlagEightLoginActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    f b2 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>b2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d d2 <span class="token operator">=</span> b2<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance().reference&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>u <span class="token operator">=</span> d2<span class="token punctuation">;</span>
</span><span class="code-line">    d h <span class="token operator">=</span> d2<span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&quot;/aws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">&quot;database.child(\&quot;/aws\&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>v <span class="token operator">=</span> h<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>The activity initializes firebase instance and fetches some information from the aws child node in the firebase storage model. Checking the above model if it is vulnerable to the .json trick of firebase, we get some information back as shown below</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:ret2csu$ <span class="token function">curl</span> https://injuredandroid.firebaseio.com/aws.json
</span><span class="code-line"><span class="token string">&quot;C10ud_S3cur1ty_lol&quot;</span>
</span></code></pre></div><p>Next step is to analyze the onClick method of the application. This is the method that responds to events of an application that if you click an object defined by the in the code.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FlagEightLoginActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">H</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token class-name">Snackbar</span> <span class="token class-name">X</span> <span class="token operator">=</span> <span class="token class-name">Snackbar<span class="token punctuation">.</span>X</span><span class="token punctuation">(</span>view<span class="token punctuation">,</span> <span class="token string">&quot;AWS CLI.&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">X<span class="token punctuation">.</span>Y</span><span class="token punctuation">(</span><span class="token string">&quot;Action&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">X<span class="token punctuation">.</span>N</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">FlagEightLoginActivity</span> flagEightLoginActivity <span class="token operator">=</span> <span class="token class-name">FlagEightLoginActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name"><span class="token namespace">flagEightLoginActivity<span class="token punctuation">.</span></span>I</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">flagEightLoginActivity<span class="token punctuation">.</span></span>H</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">return</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">k</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">throw</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FlagEightLoginActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">H</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token class-name">Snackbar</span> X2 <span class="token operator">=</span> <span class="token class-name">Snackbar<span class="token punctuation">.</span>X</span><span class="token punctuation">(</span>view<span class="token punctuation">,</span> <span class="token string">&quot;AWS profiles and credentials.&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">X2<span class="token punctuation">.</span>Y</span><span class="token punctuation">(</span><span class="token string">&quot;Action&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">X2<span class="token punctuation">.</span>N</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token class-name">FlagEightLoginActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">I</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">return</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">        d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">k</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">throw</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div><p>From the above hints provided in the application, gives hint on using of AWS CLI and understanding of AWS profiles and credentials.</p><p><strong>what are the AWS profile stored?</strong></p><p>Most of the strings are located in a file called <strong>strings.xml</strong> in the resources directory which are referenced throughout the application. In strings.xml file we have two interesting strings as shown in the code snippet below.</p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>AWS_ID<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>AKIAZ36DGKTUIOLDOBN6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>AWS_SECRET<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">
</span></code></pre></div><p>AWS CLI is a unified tool to manage your AWS services, this enables one to configure the aws services through command line and automate them through scripts. To install <strong>aws-cli</strong> on your linux machine type the following in your desktop terminal.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">python -m pip <span class="token function">install</span> --user awscli
</span></code></pre></div><p>For adding the aws profile, use the following command in the terminal as shown below.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:~$ aws configure
</span><span class="code-line">AWS Access Key ID <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: AKIAZ36DGKTUIOLDOBN6
</span><span class="code-line">AWS Secret Access Key <span class="token punctuation">[</span>None<span class="token punctuation">]</span>: KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S
</span></code></pre></div><h2 id="flag9--firebase"><a href="#flag9--firebase" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flag9- FireBase</h2><h3 id="what-is-firebase"><a href="#what-is-firebase" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>What is firebase?</h3><p>Google firebase is a mobile and web application development platform that provides a real-time database that continuously syncs data between the cloud and the userâ€™s mobile devices. Firebase databases are accessible via an API and that if developers have not correctly secured their firebase database, a simple web request can retrieve its entire content.</p><p>We need to analyze the FlagNineFirebaseActivity in order to understand how read and write rules are implemented in the application.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"> <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">goToFlagNineFirebaseActivity</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">startActivity</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">FlagNineFirebaseActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">FlagNineFirebaseActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decode <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;ZmxhZ3Mv&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//  flags/ </span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>v <span class="token operator">=</span> decode<span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>decode<span class="token punctuation">,</span> <span class="token string">&quot;decodedDirectory&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">Charset</span> charset <span class="token operator">=</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>charset<span class="token punctuation">,</span> <span class="token string">&quot;StandardCharsets.UTF_8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decode<span class="token punctuation">,</span> charset<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    f b2 <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>b2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d d2 <span class="token operator">=</span> b2<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span> <span class="token string">&quot;FirebaseDatabase.getInstance().reference&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> d2<span class="token punctuation">;</span>
</span><span class="code-line">    d h <span class="token operator">=</span> d2<span class="token punctuation">.</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">&quot;database.child(refDirectory)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> h<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Decode the base64 encoded string in order to understand strings stored in the decode variable. To decode the string we use linux utility called base64.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:~$ <span class="token class-name builtin">echo</span> <span class="token string">&quot;ZmxhZ3Mv&quot;</span> <span class="token operator">|</span> base64 -d
</span><span class="code-line">            flags/
</span></code></pre></div><p>From the above analysis,we are getting data from firebase storage, in the <strong>flags</strong> node.</p><p>Clicking on the hint view button in the application, we get hint on how to solve the challenge level. When the hint view is clicked it shows a string hint of <strong>&quot;Use the .json trick database url&quot;</strong> as shown in the decompiled code below.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">String</span> str<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FlagNineFirebaseActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">H</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">                str <span class="token operator">=</span> <span class="token string">&quot;Use the .json trick with database url&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">                d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">k</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">                <span class="token keyword">throw</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FlagNineFirebaseActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">H</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>view <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">                str <span class="token operator">=</span> <span class="token string">&quot;Filenames.&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">                d<span class="token punctuation">.</span>m<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">k</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">                <span class="token keyword">throw</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div><h3 id="firebase-realtime-rules"><a href="#firebase-realtime-rules" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Firebase Realtime Rules</h3><p>Realtime database stores data as one large JSON tree and synchronized every time a new device is connected.The data received or stored in the database is determined by the security rules of read and write.</p><p>Firebase allows read and write rules to the database to be set to true or false. when <strong>.read</strong> is set to true means describes if and data is allowed to be read by users and <strong>.write</strong> describes if and when data is allowed to be written. Example of a firebase rule where read and write are allowed.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token property">&quot;.read&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token property">&quot;.write&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>When read and write rules are enabled means that everyone with access to the application can read and write unauthorized data to the database.</p><p>The firebase database url is defined in <strong>strings.xml</strong> file in the resource section.</p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>firebase_database_url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>https://injuredandroid.firebaseio.com<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><p>The firebase node defined in our instance is <strong>flags</strong> node, to check if the endpoint node is vulnerable we append a <strong>.json</strong> at the end of the url node as shown in the image below.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">vx@archie:injured$ <span class="token function">curl</span> https://injuredandroid.firebaseio.com/flags/.json
</span><span class="code-line"><span class="token string">&quot;[nine!_flag]&quot;</span>
</span></code></pre></div><p>If the url returns some data, that means that our endpoint is vulnerable. From the above output we were able to successfully solve the challenge.</p><h3 id="securing-firebase"><a href="#securing-firebase" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Securing Firebase</h3><p>One can secure Firebase database by only allowing users of application to have only read permissions to a certain tree node instead of allowing read to the root node in the application. This means the applications can not read data from the neighboring nodes.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;flag&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;.read&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;.write&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/android">Android</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/appsec">Appsec</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/android-security-part1">Android Application Security Series- Part 1</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/virtual-machine">Reversing 8-bit Bytecode Virtual Machine</a></div></div></div></div><div class="sticky top-0 pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">â† Back to the Blog</a><div class="hidden md:block"><div class="mt-5 space-y-1 text-sm"><p class="text-lg font-bold">Table of content</p></div></div></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:thuri783@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/thuri10"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/0xhexski"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Thuri10</div><div> â€¢ </div><div>Â© 2022</div><div> â€¢ </div><a href="/">Solar Bits</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{for(var c in s)l(a,c,{get:s[c],enumerable:!0})},i=(a,s,c,e)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let t of h(s))!m.call(a,t)\u0026\u0026t!==c\u0026\u0026l(a,t,{get:()=\u003es[t],enumerable:!(e=d(s,t))||e.enumerable});return a};var g=(a,s,c)=\u003e(c=a!=null?p(u(a)):{},i(s||!a||!a.__esModule?l(c,\"default\",{value:a,enumerable:!0}):c,a)),b=a=\u003ei(l({},\"__esModule\",{value:!0}),a);var r=N((A,o)=\u003e{o.exports=_jsx_runtime});var v={};k(v,{default:()=\u003ey,frontmatter:()=\u003ef});var n=g(r()),f={title:\"Android Application Security Series - Part2\",date:\"2021-10-25\",draft:!1,tags:[\"Android\",\"Appsec\"],summary:\"Firebase, Local Sqlite and AWS storage security weaknesses.\",images:[\"/static/images/android/firebase.jpg\"]};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",h2:\"h2\",strong:\"strong\",pre:\"pre\",code:\"code\",h3:\"h3\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"insecure-storages\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#insecure-storages\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Insecure Storages\"]}),(0,n.jsx)(e.p,{children:\"This is the second part series of the android application security. This part focuses on the security of sqlite databases, firebase and AWS security.\"}),(0,n.jsxs)(e.h2,{id:\"flag7---sqlite\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#flag7---sqlite\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Flag7 - Sqlite\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"What is sqlite?\"})}),(0,n.jsx)(e.p,{children:\"Sqlite is a structure query base database that enables applications to do local storage in the application directory. The goal of the challenge is to understand how local storage of databases may lead to leakage of information.\"}),(0,n.jsx)(e.p,{children:\"First step is to decompile the FlagSevenSqliteActivity using jadx.\"}),(0,n.jsxs)(e.p,{children:[\"During the analysis of new android activity, we start analysis on the onCreate method.\",(0,n.jsx)(e.strong,{children:\"oncreate\"}),\" is the first method to be called by an application when an activity is started.\"]}),(0,n.jsx)(e.p,{children:\"The decompiled oncreate method is as shown below.\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"onCreate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Bundle\"}),\" bundle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"super\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"onCreate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bundle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setContentView\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"layout\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"activity_flag_seven_sqlite\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"C\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Toolbar\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"findViewById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"toolbar\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    j\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"g\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FloatingActionButton\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"findViewById\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"fab\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setOnClickListener\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SQLiteDatabase\"}),\" writableDatabase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"u\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getWritableDatabase\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ContentValues\"}),\" contentValues \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ContentValues\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"put\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"title\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"VGhlIGZsYWcgaGFzaCE=\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"put\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"subtitle\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    writableDatabase\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"insert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Thisisatest\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"put\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"title\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"put\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"subtitle\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"c\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    writableDatabase\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"insert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Thisisatest\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" contentValues\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"From the analysis of the above code, the method is passing some base64 encoded strings and storing them into string variables.From the hint of application name, we are creating writable database through SQLiteDatabase functions. In this application we are writing some strings to the database. The name of the database being referenced is \",(0,n.jsx)(e.strong,{children:\"Thisisatest\"}),\" database.\"]}),(0,n.jsx)(e.p,{children:\"Next step is decode all base64 encoded strings in order to understand the logic of the program. The decoded strings below.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"VGhlIGZsYWcgaGFzaCE    - The flag hash\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),` \n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc - 2ab96390c7dbe3439de74d0c9b0b1767\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ  - The flag is also a password\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"The above decoded strings gives us an hint on solving the challenge. The author provides us with the hash of the flag.\"}),(0,n.jsx)(e.p,{children:\"The activity defines some interesting strings in the application, we decode the strings as shown in the code below.\"}),(0,n.jsx)(e.pre,{className:\"language-kotlin\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-kotlin\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" String w \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token singleline string-literal\",children:(0,n.jsx)(e.span,{className:\"token string\",children:'\"ZjFhZy1wYTU1\"'})}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\"   #f1ag\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),`pa55\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" byte\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Base64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token singleline string-literal\",children:(0,n.jsx)(e.span,{className:\"token string\",children:'\"c3FsaXRl\"'})}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`  #sqlite\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" byte\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" y \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" Base64\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" String z\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"Next is to analyze the FlagSevensqliteActivity in order to understand the usage of the above strings in our activity. Important strings form the above are \",(0,n.jsx)(e.strong,{children:\"f1ag-pa55\"}),\" and \",(0,n.jsx)(e.strong,{children:\"sqlite\"}),\".\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagSevenSqliteActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"byte\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" bArr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//sqlite\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bArr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"decodedDirectoryOne\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Charset\"}),\" charset \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"StandardCharsets\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"UTF_8\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"charset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"StandardCharsets.UTF_8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"z \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bArr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" charset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"byte\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" bArr2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"y\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//f1ag-pa55\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bArr2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"decodedDirectoryTwo\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Charset\"}),\" charset2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"StandardCharsets\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"UTF_8\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"charset2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"StandardCharsets.UTF_8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"A\"]}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bArr2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" charset2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        f b2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance()\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d d2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance().reference\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"B\"]}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d h \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"z\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"database.child(refDirectory)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"C\"]}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d h2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"B\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"A\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"h2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"database.child(refDirectoryTwo)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"this\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"D\"]}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" h2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsxs)(e.p,{children:[\"From the above decompiled \",(0,n.jsx)(e.strong,{children:\"flagSevensqliteActivity\"}),\", shows how the application is parsing the data from the firebase instance. In order to understand the data we are fetching, we need to know the nodes we are fetching the data from. From the decompiled code, we are accessing the string x as shown in the constructor method in line 1 through bArr byte array. our string is then passed to variable z constructor method as referenced by \",(0,n.jsx)(e.strong,{children:\"this.z\"}),\" constructor.\"]}),(0,n.jsxs)(e.p,{children:[\"This means, \",(0,n.jsx)(e.strong,{children:\"f1ag-pa55\"}),\" and \",(0,n.jsx)(e.strong,{children:\"sqlite\"}),\" are our firebase nodes.\"]}),(0,n.jsxs)(e.p,{children:[\"To get the firebase link, we look for the link the \",(0,n.jsx)(e.strong,{children:\"strings.xml\"}),\" in the resources directory of the application.The link of the firebase url is shown in the image below. Manually test firebase endpoints manually to see if they are vulnerable as shown in the code below. Adding .json at the end of the firebase endpoint enables one to read data.\"]}),(0,n.jsxs)(e.p,{children:[\"First we test our endpoint using \",(0,n.jsx)(e.strong,{children:\"sqlite\"}),\" node.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"vx@archie:output$ \",(0,n.jsx)(e.span,{className:\"token function\",children:\"curl\"}),` https://injuredandroid.firebaseio.com/sqlite.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'\"S3V3N_11\"'}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"From the results of the above, we get our flag. Accessing the endpoint using \",(0,n.jsx)(e.strong,{children:\"f1ag-pa55\"}),\" using .json firebase trick, we get our password.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"vx@archie:output$ \",(0,n.jsx)(e.span,{className:\"token function\",children:\"curl\"}),` https://injuredandroid.firebaseio.com/f1ag-pa55.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'\"hunter2\"'}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"hunter2\"}),\" is our correct password for the challenge.\"]}),(0,n.jsxs)(e.h2,{id:\"flag8---aws-storage-and-security\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#flag8---aws-storage-and-security\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"FLag8 - AWS Storage and Security.\"]}),(0,n.jsx)(e.p,{children:\"This challenge is about understanding the misconfiguration of AWS storage and security implementation in the android applications.\"}),(0,n.jsx)(e.p,{children:\"The decompiled flagEightclass activity code looks like the one below.\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    f b2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance()\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d d2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance().reference\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"u \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d h \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"/aws\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"database.child(\\\\\"/aws\\\\\")\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"v \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"The activity initializes firebase instance and fetches some information from the aws child node in the firebase storage model. Checking the above model if it is vulnerable to the .json trick of firebase, we get some information back as shown below\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"vx@archie:ret2csu$ \",(0,n.jsx)(e.span,{className:\"token function\",children:\"curl\"}),` https://injuredandroid.firebaseio.com/aws.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'\"C10ud_S3cur1ty_lol\"'}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Next step is to analyze the onClick method of the application. This is the method that responds to events of an application that if you click an object defined by the in the code.\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"onClick\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"View\"}),\" view\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Snackbar\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"X\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Snackbar\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"X\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AWS CLI.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"X\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Y\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Action\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"X\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"N\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),\" flagEightLoginActivity \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"flagEightLoginActivity\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"I\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"flagEightLoginActivity\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"H\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"k\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Snackbar\"}),\" X2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Snackbar\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"X\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"AWS profiles and credentials.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"X2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Y\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Action\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"X2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"N\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagEightLoginActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"I\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"k\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsx)(e.p,{children:\"From the above hints provided in the application, gives hint on using of AWS CLI and understanding of AWS profiles and credentials.\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"what are the AWS profile stored?\"})}),(0,n.jsxs)(e.p,{children:[\"Most of the strings are located in a file called \",(0,n.jsx)(e.strong,{children:\"strings.xml\"}),\" in the resources directory which are referenced throughout the application. In strings.xml file we have two interesting strings as shown in the code snippet below.\"]}),(0,n.jsx)(e.pre,{className:\"language-xml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-xml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"string\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"name\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"AWS_ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"AKIAZ36DGKTUIOLDOBN6\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"string\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"string\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"name\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"AWS_SECRET\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"string\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsxs)(e.p,{children:[\"AWS CLI is a unified tool to manage your AWS services, this enables one to configure the aws services through command line and automate them through scripts. To install \",(0,n.jsx)(e.strong,{children:\"aws-cli\"}),\" on your linux machine type the following in your desktop terminal.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"python -m pip \",(0,n.jsx)(e.span,{className:\"token function\",children:\"install\"}),` --user awscli\n`]})})}),(0,n.jsx)(e.p,{children:\"For adding the aws profile, use the following command in the terminal as shown below.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`vx@archie:~$ aws configure\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"AWS Access Key ID \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"None\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`: AKIAZ36DGKTUIOLDOBN6\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"AWS Secret Access Key \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"None\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`: KKT4xQAQ5cKzJOsoSImlNFFTRxjYkoc71vuRP48S\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"flag9--firebase\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#flag9--firebase\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Flag9- FireBase\"]}),(0,n.jsxs)(e.h3,{id:\"what-is-firebase\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#what-is-firebase\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is firebase?\"]}),(0,n.jsx)(e.p,{children:\"Google firebase is a mobile and web application development platform that provides a real-time database that continuously syncs data between the cloud and the user\\u2019s mobile devices. Firebase databases are accessible via an API and that if developers have not correctly secured their firebase database, a simple web request can retrieve its entire content.\"}),(0,n.jsx)(e.p,{children:\"We need to analyze the FlagNineFirebaseActivity in order to understand how read and write rules are implemented in the application.\"}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"goToFlagNineFirebaseActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"View\"}),\" view\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token function\",children:\"startActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Intent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagNineFirebaseActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagNineFirebaseActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"byte\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" decode \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"decode\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"ZmxhZ3Mv\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\"     \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//  flags/ \"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"v \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"decodedDirectory\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Charset\"}),\" charset \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"StandardCharsets\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"UTF_8\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"charset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"StandardCharsets.UTF_8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"w \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"decode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" charset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    f b2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" f\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance()\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d d2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" b2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"FirebaseDatabase.getInstance().reference\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d h \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" d2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"database.child(refDirectory)\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"y \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" h\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Decode the base64 encoded string in order to understand strings stored in the decode variable. To decode the string we use linux utility called base64.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"vx@archie:~$ \",(0,n.jsx)(e.span,{className:\"token class-name builtin\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"ZmxhZ3Mv\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),` base64 -d\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`            flags/\n`})]})}),(0,n.jsxs)(e.p,{children:[\"From the above analysis,we are getting data from firebase storage, in the \",(0,n.jsx)(e.strong,{children:\"flags\"}),\" node.\"]}),(0,n.jsxs)(e.p,{children:[\"Clicking on the hint view button in the application, we get hint on how to solve the challenge level. When the hint view is clicked it shows a string hint of \",(0,n.jsx)(e.strong,{children:'\"Use the .json trick database url\"'}),\" as shown in the decompiled code below.\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"onClick\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"View\"}),\" view\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" str\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagNineFirebaseActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Use the .json trick with database url\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"k\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FlagNineFirebaseActivity\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"view \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Filenames.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"m\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"k\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"throw\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),(0,n.jsxs)(e.h3,{id:\"firebase-realtime-rules\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#firebase-realtime-rules\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Firebase Realtime Rules\"]}),(0,n.jsx)(e.p,{children:\"Realtime database stores data as one large JSON tree and synchronized every time a new device is connected.The data received or stored in the database is determined by the security rules of read and write.\"}),(0,n.jsxs)(e.p,{children:[\"Firebase allows read and write rules to the database to be set to true or false. when \",(0,n.jsx)(e.strong,{children:\".read\"}),\" is set to true means describes if and data is allowed to be read by users and \",(0,n.jsx)(e.strong,{children:\".write\"}),\" describes if and when data is allowed to be written. Example of a firebase rule where read and write are allowed.\"]}),(0,n.jsx)(e.pre,{className:\"language-json\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-json\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"rules\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token property\",children:'\".read\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token property\",children:'\".write\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"When read and write rules are enabled means that everyone with access to the application can read and write unauthorized data to the database.\"}),(0,n.jsxs)(e.p,{children:[\"The firebase database url is defined in \",(0,n.jsx)(e.strong,{children:\"strings.xml\"}),\" file in the resource section.\"]}),(0,n.jsx)(e.pre,{className:\"language-xml\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-xml\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"string\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"name\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"firebase_database_url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"https://injuredandroid.firebaseio.com\",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"string\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})})}),(0,n.jsxs)(e.p,{children:[\"The firebase node defined in our instance is \",(0,n.jsx)(e.strong,{children:\"flags\"}),\" node, to check if the endpoint node is vulnerable we append a \",(0,n.jsx)(e.strong,{children:\".json\"}),\" at the end of the url node as shown in the image below.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"vx@archie:injured$ \",(0,n.jsx)(e.span,{className:\"token function\",children:\"curl\"}),` https://injuredandroid.firebaseio.com/flags/.json\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:'\"[nine!_flag]\"'}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"If the url returns some data, that means that our endpoint is vulnerable. From the above output we were able to successfully solve the challenge.\"}),(0,n.jsxs)(e.h3,{id:\"securing-firebase\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#securing-firebase\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Securing Firebase\"]}),(0,n.jsx)(e.p,{children:\"One can secure Firebase database by only allowing users of application to have only read permissions to a certain tree node instead of allowing read to the root node in the application. This means the applications can not read data from the neighboring nodes.\"}),(0,n.jsx)(e.pre,{className:\"language-json\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-json\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"rules\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"flag\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\".read\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\".write\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})})]})}}var y=w;return b(v);})();\n;return Component;","toc":[{"value":"Insecure Storages","url":"#insecure-storages","depth":1},{"value":"Flag7 - Sqlite","url":"#flag7---sqlite","depth":2},{"value":"FLag8 - AWS Storage and Security.","url":"#flag8---aws-storage-and-security","depth":2},{"value":"Flag9- FireBase","url":"#flag9--firebase","depth":2},{"value":"What is firebase?","url":"#what-is-firebase","depth":3},{"value":"Firebase Realtime Rules","url":"#firebase-realtime-rules","depth":3},{"value":"Securing Firebase","url":"#securing-firebase","depth":3}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.825,"time":769500,"words":2565},"slug":"android-security-part2","fileName":"android-security-part2.mdx","title":"Android Application Security Series - Part2","date":"2021-10-25","draft":false,"tags":["Android","Appsec"],"summary":"Firebase, Local Sqlite and AWS storage security weaknesses.","images":["/static/images/android/firebase.jpg"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.53,"time":31800,"words":106},"slug":["default"],"fileName":"default.md","name":"Thuri","avatar":"/static/images/profile.png","occupation":"Software Developer","email":"thuri783@gmail.com","github":"https://github.com/thuri10"}],"prev":{"title":"Android Application Security Series- Part 1","date":"2021-10-20T00:00:00.000Z","tags":["android","ctf","Appsec"],"images":"/static/images/android.jpg","draft":false,"layout":"PostLayout","summary":"Intents, Exported Activity, Resources and Weak Cryptographic Algorithms","slug":"android-security-part1"},"next":{"title":"Reversing 8-bit Bytecode Virtual Machine","date":"2021-12-07T00:00:00.000Z","tags":["reverse","malware"],"draft":false,"summary":"Can you figure out how the VM works and write your own to decrypt the flag?","images":"/static/images/mal/vm.jpg","layout":"PostLayout","slug":"virtual-machine"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["android-security-part2"]},"buildId":"bDYVdcnFQ4pUuvvBtmBw4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>